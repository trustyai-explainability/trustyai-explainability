package org.kie.trustyai.metrics.drift.meanshift;

import java.util.ArrayList;
import java.util.List;
import java.util.Map;
import java.util.Random;
import java.util.concurrent.atomic.AtomicInteger;

import org.junit.jupiter.api.Test;
import org.kie.trustyai.explainability.model.Dataframe;
import org.kie.trustyai.explainability.model.Feature;
import org.kie.trustyai.explainability.model.FeatureFactory;
import org.kie.trustyai.explainability.model.PredictionInput;

import static org.junit.jupiter.api.Assertions.*;

class MeanshiftTest {
    // lists of reference columns (drawn from 5 random normal distributions)
    // shape = 25 x 100
    double[][] cols = {
            { 8.244607628338347, -1.3424610552112637, 8.860105920982443, -7.6754528218505556, 3.743108455052322, 0.17882886661011466, 10.111649070923376, 0.17503414002271378, 13.946838495539602,
                    2.4610936877646346, 4.883243100913084, 11.48599959697692, 11.275442703340458, 2.464630817190849, 0.557017995930827, -5.282316320953386, 4.795072558266622, -4.079630822040675,
                    -1.8930035990517, -1.2532669972647348, -4.719227758587169, -1.882801155373277, -2.5174764493874995, -7.570377597598894, 0.24770848896870834, 6.8367641078792865, 6.242050420757062,
                    2.4560002400198533, -5.651758237141156, 4.060578972665324, 9.325731839351517, -3.74817560474687, -9.392928577747895, 7.367238445690187, 1.6920151219964712, -1.4841434831680855,
                    1.7187846050163234, 3.2066241058515317, -10.229726444279047, 11.687462246030785, 15.830358963522563, -2.0667648358087183, 9.132075053118976, -6.584020300779947, 7.860139770235929,
                    -3.5445842866975914, 1.906868597969508, 3.550430059402453, 1.1498169721218037, 7.795859962954732, 0.5035826496941881, -3.323580487964872, 0.6913506326823834, -1.370050215235226,
                    0.8965356558313099, 1.2483303050138508, 13.631246894627695, -0.3053498111923414, 3.111172346225451, -8.297661069847248, 1.154073858273159, 8.214189587629647, -0.4707832098739866,
                    -1.7376696994077485, 7.434111207941867, 3.7602942735582334, -3.2279378437746358, -8.704005847407181, -6.972328740910267, 2.2293511070091085, -5.472222771903295,
                    -1.3982795559894274, 12.196738196232, 4.81037990267436, -2.5268243645735122, -10.130992579072641, -2.762867691800771, 10.192846763596622, 2.7653767819472397, 6.076683587557324,
                    3.056527817895385, 5.500063209981006, 3.486967923287637, 0.7097492316074209, 2.8873694907763348, -1.7705883283266388, 12.134989450740413, -4.632368070027162, -4.326375765537513,
                    -6.126898839982231, 1.5364529379065393, 3.9234010172754195, 3.760288808528596, 14.362900527845143, -2.497252343201923, -7.92692876306309, -2.2041399857588395, 16.010993493296475,
                    12.63080907194257, -0.6347275850222645 },
            { 10.021630136441766, -3.254282651873922, -0.6758669336997032, -3.637904519956522, -2.2586180222812064, 1.3356800677268712, -2.1819052941473065, -1.4776266304577508, 2.653880913433974,
                    -9.883461825652745, -4.945253597338495, 0.20620863279869184, -1.906208600937902, -12.867536512627536, 1.0411034255241298, -2.6292567478631903, 4.08241136963606,
                    -2.7320793745358305, -0.6544032670460176, 7.692579263500053, 0.8246172040510016, 1.5538433833322545, -2.862455421487706, 0.29358070974483585, 5.773943860198767, -3.900111156481798,
                    0.08311016422853013, -12.748464847034771, -5.676560927551944, -2.365921052988102, 0.060392150199954475, -7.268440472712099, 10.545277108534352, 11.693440220186044,
                    0.9771718239910915, 10.70239141607616, 1.6513645693442174, -0.5483187353324415, 6.268952722715224, 3.578296100171501, -8.313249571538902, 2.7282503317760716, -3.4842948455409033,
                    -3.4257112936984413, -8.79113864223576, 15.165859885626784, 7.701158221466304, 0.7616005289892557, 1.4002432482787106, 2.6929644120887204, 8.415950710187182, 1.8678809216401882,
                    0.02160285238033499, 11.852012479968149, 7.253276566750728, 11.36014185662147, -0.6845028445304044, 12.66577598340484, 6.739896504701721, 0.3524905567744696, -1.4597648959459733,
                    -2.287418286327071, -7.825142506923761, 8.29507085418359, -3.549443816791129, -10.44538491117202, 3.1750052659226657, 5.686399229086288, -6.053343205165116, -17.611133345655023,
                    -3.2961753890750245, 5.535819985573277, -1.3398922724209976, 5.704101659638075, 0.7413807839441454, 4.7800323477053945, -4.059345250735363, 4.052900720278764, 6.362252651959116,
                    9.461979728512222, -2.9101303351986467, -2.5578286972355864, 4.913968659967599, 5.878168191230067, -6.683512105897657, 6.979206303985651, 4.509000994397484, -4.640375650939346,
                    8.878318949205173, 0.12091016384352093, -2.2848248079543096, -1.8963943859285282, 3.41217056590325, -3.13876329812238, 0.2996754625958238, 0.000698597859981831, 6.431659885057384,
                    6.845137789195567, 7.321673119462051, -6.651422125614354 },
            { 3.34072893069684, 4.412992394177048, 0.4009696915524761, 6.798388034431023, 15.957730557988107, 6.099161566092531, 6.4289379045212645, 10.042859769746748, 3.27261545850027,
                    -2.1732900852121375, 4.209772790488864, 8.910664710510668, 3.790050230585233, 12.305105617868389, 4.230810333886669, 12.487154215449467, 2.6396118795092987, 6.179714674573308,
                    5.887397441480839, 6.349803373234066, -2.3389121250803546, -3.9799347325153285, 0.8683490686380559, -2.720774210835784, 10.569337048193646, -4.1949882702902705, 9.292077592373367,
                    1.6031481315605531, -3.4658299981853844, -0.5893368200031706, -2.725556804025829, 0.7388689866984053, 5.709671479053379, 3.7614835564152935, 4.400587115406981, 2.8978786547744084,
                    7.334595344601777, 2.7568136264885164, 7.858264311585926, -0.6925300211522911, 3.045510612951113, 10.060429623189254, 7.304675139734387, 6.59936454467412, 0.832025540948548,
                    3.262851594836035, 6.795835657288963, -2.306436343154191, -2.5446901322383964, -9.048024278121762, 11.12868109879156, -7.209169216056715, 9.308331205666905, 3.4808770970957,
                    9.759541396364472, 3.1928252424475954, 0.4960085613459464, 4.3897895963076, -0.5725644350002419, 6.963624818619242, 6.304596681135603, 8.135034847427862, 5.819943000496491,
                    2.3133153471817485, 5.170625202524578, 6.016538992694073, -9.602122631507543, 0.11793685846947444, 4.166932240025405, 8.822854120552787, -1.0156064746768738, 2.9092925213280116,
                    10.846279511676332, 3.733825074725508, -0.9599264956974451, 5.177058746577482, 6.0242321872720215, 0.2039645289946339, -4.357588872470421, 6.252729632324761, 3.4490337354634586,
                    3.416725907331181, 5.263803351344575, -0.20406026088693086, 0.2353464327019248, -6.892169194663177, 11.521774572672046, 6.980676490341848, -0.29938496081766974, 1.0002390921131417,
                    7.030776852264921, 4.324387106272212, 0.36597884464352193, 4.8693329748112335, 8.590797553112544, 5.740714147362708, 6.435161499928406, 4.937595488562264, 3.9291693600906217,
                    7.413019060630816 },
            { 3.7892950696844006, 5.936513433486262, 2.6145747936316983, -1.0811307738245546, -4.2653587975345975, 2.037248853819728, 6.840912709893008, -1.6199744510386163, 1.1552306572495907,
                    3.784738367044614, 0.7675748175534935, 1.1579249687153461, 1.7940324758757868, 2.6248650296604623, 5.579940590763723, 4.622600166856882, 4.222596323556986, 4.741537692274261,
                    6.177014823125425, -0.2461913439664274, 5.578165473315316, 4.278543339560378, 0.0036192012590081646, 0.7848872523604484, -0.9393244962447804, 7.659069389944326, 5.255651291564595,
                    13.42503759282801, 10.926565146346405, -4.889153035361229, 8.706233769141704, -0.23449470769569203, -3.5958329415791503, -0.5192817919323192, 9.02351153880539, 2.033873396330839,
                    3.0718640210779133, 6.755891860999784, 7.608485247992326, -0.33853538679876394, 4.542157926986549, 3.847477368759488, 2.765188318560461, 6.884672930903008, -2.1679880606365716,
                    -1.9228860067665883, 0.6872991573231313, 7.735383985467951, 3.4486666359667533, -1.2299205843306638, 8.053617312586557, 2.142131245508267, 4.367835472861198, -2.7259044492567828,
                    5.012632729479213, 6.645046579961397, 7.9383368624248565, 8.870576940995726, 0.9739792785416759, 3.9299508072652927, 0.8470074849604265, 2.2434533402544496, -0.21672360861821094,
                    3.2921438521873982, -2.74243212377419, 10.56391827705615, -3.246279935032378, 5.875817583860182, 8.163021898112852, 5.200898380721453, 9.604559117122221, -5.189331122597261,
                    2.8377781046536272, -3.209460530172226, -2.0931492800601808, 1.804717638523298, -4.307614809728891, 4.570204426203308, 6.267323770072847, -5.6800435224178525, 0.8520577986282327,
                    9.499132839667897, 0.18511977718666728, 3.7426705723580787, 9.871586330985831, 0.7899850293993911, 8.777255404470102, 10.902059495684657, 0.2633621484163431, 7.186513665243574,
                    9.931038795176354, -0.7506382795918265, 4.823975488018226, 8.82032175413822, 6.666550117511923, -5.547443720647067, 2.800162158352447, 4.006475121288712, 9.452382574808487,
                    -2.325725217866739 },
            { -1.9352445690588436, -4.500463685266468, 17.74512449006331, 3.834520084557542, -12.0818568487065, -4.387652381215931, 5.310535058082183, 0.47570871990899305, -5.6589419518210065,
                    19.383227872913498, 11.312287789505287, 13.869974969129233, 3.182013200678362, 1.0951354778132134, 12.582933950423294, -3.556561773360775, 13.272387449463507, -0.5787560676679535,
                    10.493618517242128, 1.8669662631676638, -2.4807114920780204, 8.376803589954026, 11.07296753150602, -20.884258166150854, -13.143887651350209, 15.061303811065704, -9.069021913319078,
                    2.0053198527367613, -10.317424181394784, 10.417244531278579, -2.160516064146764, -5.661084950191584, 4.632530730835676, -14.180573705565356, 2.5153305589817476, 9.103519517695766,
                    -12.86297294953765, 6.042303628073917, -9.7231612733386, 3.323580559928354, 11.88834734968551, -13.493773591276378, 7.781657828534894, -1.425413824857094, -0.7979859292688287,
                    10.644743623034573, -25.512555557004735, 19.259388150402074, -1.6874074368518062, -11.609282821944955, 6.641603409127926, -7.441637114788749, -18.37753247461866,
                    3.3690515003015897, 1.3035497168562389, 2.062373818186491, -8.034819330658467, -5.268938789043892, -1.1782543695344971, 5.5305797634875224, 17.329913074349083, -11.054248518662337,
                    -0.6809501329123797, 10.048228706900657, 2.3718168134876656, 7.753174302833703, 19.71343503674161, -12.936303377416948, 13.918734690954052, -11.167612948731845, 11.052276604400575,
                    5.705090517295588, -3.5843763106474906, -0.04474623354882523, 0.5700383709481578, 3.9594886967559484, 2.64450729840099, 5.341255916482753, 5.245869742556806, -14.937194451872779,
                    -2.857479076721235, -1.1488182427135754, -3.0764597960057283, -5.124811536986391, -0.8578177775694031, 2.929631936175113, -16.951740732694944, -5.912266808895359,
                    7.399500770842913, 2.1400922432555975, 9.567946492337617, 3.026748830479464, -5.52708724605571, 7.154594842841165, -5.695479563022908, 6.516629671983558, 3.040041319687078,
                    -6.468128327453192, -6.817240826224304, -1.350427445455432 },
            { -2.663904678835406, 0.44312452941568803, -9.121144466338329, -11.583207425750585, 0.4661181011125315, -1.491116108990864, -12.622244176436354, -5.857955119175568, -7.857014318121958,
                    -6.8818901720763055, -1.737547869519959, -2.3308600328507185, 2.917108143359518, 4.2021568110862475, -0.5550541673904718, 0.8150671663675064, -6.080683320942098,
                    -5.885857869171666, 0.33301336794017833, 0.7208575127441819, 2.229026818907545, -5.36921271811797, -9.387263882791153, 3.296891653500987, -4.808565799252794, -1.2827367438551436,
                    -1.8972736656045126, -1.3964479208014078, -0.2627447112441419, 1.1752923159274609, 2.2320641374774155, -3.0891811987634767, 1.3759711969841941, 2.03607212789351,
                    -7.015450859728066, 2.2745638361162603, -8.222471706037052, -0.419643097726383, -1.354128195395732, -5.993470461624045, -3.8110699146614593, -6.380890716112548, 3.185416907287294,
                    -5.240716432538754, -8.204723207463179, -3.9870157730618625, -2.0321812494424036, -4.3042092245689325, -5.746420414371891, -2.914502056425648, -4.293095930958172,
                    -2.55157225534185, -0.09666410863761454, 1.640081984869528, -6.373135071549382, 7.2290673349201295, -6.515785581018624, 1.3602864963848198, -5.664663342711268, -0.9527255584220361,
                    -1.26980953326376, -7.00527992391287, -6.853907374302366, -3.611550478573512, 4.31275138723847, 0.4942481902751088, 3.6291933328009733, 5.585452954339833, 0.45949085798143807,
                    -5.043244311634251, -1.2730401284657953, -0.41226112100663337, 2.4897702896847616, -3.8042867828354168, -2.6595352127042915, 2.9699816365819345, 1.0509074371970137,
                    -2.0251574879509224, -4.829598361709243, -2.1291561120250106, -1.3150710591840522, -0.1790937357172664, -6.598375483500602, 3.849175026232875, 1.5049954885712564,
                    5.5508930091518796, -0.4354065168896164, -0.7775545294204652, 1.859199565252724, -2.346512002024691, -0.8156258689917778, -3.1947479508155876, -0.6702618450298045,
                    -7.453984156226787, 1.320072787496282, 1.6254632710567885, -2.0590856066202123, 5.361009782330047, -3.6762477315539304, -3.760514465253948 },
            { 0.09745990513578184, -7.611878380309882, 5.192347570610548, 5.43718761887511, -2.1363588212912257, 0.122514782642267, -6.239617033097902, 0.4626582158562311, -11.771042774224027,
                    5.776804094576875, -6.366355707631367, 4.178607107813679, -10.482730166852607, -3.206707253482013, 1.0699528383301862, -12.754405024856004, 3.0821251650710204, -1.3258680774535314,
                    -13.482594628083046, -9.56669949438954, 7.451565053587459, 10.041594007467449, 0.8789418861762417, 5.664824078686344, 4.0514439830459565, 4.994756280420786, 13.52332569095044,
                    -11.383737316060412, 8.08776169352656, -1.3513852049797315, 0.055386893935113646, -0.6401139697020475, -1.2901931781649023, -8.879619053506136, 3.690237000262225,
                    16.95628634629316, 1.5546884005473782, 2.0429160842720004, -4.073879726565441, 1.0076612336849482, 6.212413847515128, -1.2464546022050529, -1.9916343931268932, 5.65147181233672,
                    -6.1312511617050465, 4.306964269589841, 9.370675828940547, 14.182921440660147, 1.2492651829721717, 14.251130465470101, 11.279855606495616, -6.828687835774566, -8.805979291081961,
                    -0.6643158631556814, 11.231036439857883, 1.4106315049394533, -3.3012344049163334, 15.897753107587109, 4.613804283478782, -18.639165687763388, 4.883620355822426, 6.692849315277075,
                    4.067184589433914, 6.065678612551832, 1.4553218049459873, -9.701830887484965, -1.2505706921054571, -6.377478834468798, -6.262664088280246, -9.208434997285158, 6.090443081077057,
                    2.928278915029051, -1.9413501818107632, -3.7353528019045763, 1.846386594906736, 11.679234732603629, -15.817787106817825, 5.416150580667985, -2.811244524892623, -14.750960220654655,
                    -15.295987249607801, -6.084689234860932, 4.0127944741319315, 5.560496642749226, -6.318316626026572, 11.124786135142427, 14.745050148948318, 5.587460745795257, -3.218701795984786,
                    12.082534224510377, 8.791682384428496, 9.790572622678788, -3.7988982919050667, -23.222524249058967, 20.932238334003486, -12.310111155963053, 1.7362975136830934, 23.28611178098511,
                    5.003261780748925, 10.520391283501226 },
            { 5.422654626891914, -1.1806316479316323, -1.2786966889436475, 13.111996215867206, 4.2890187674275335, -9.346994906890144, 4.991606006419049, -4.102146787953917, 2.167163154920309,
                    4.243309429723597, -3.978440026871894, 4.298899013788768, 0.8611731332569373, 11.785231050387875, -0.3757166245153314, -3.9364588918587593, 4.522470529778603, 11.379867743472342,
                    5.065756435183108, 1.6566897835367742, 13.476995658390996, 12.531261471017553, 10.3869572183384, 5.62559678274743, -4.55904821602391, 6.073167045293196, -7.8216985687368314,
                    8.9054787656901, 4.804136986232306, 11.269915563648974, -4.233652123013112, 6.356354892364653, 1.289683935731221, -7.170763032758252, -1.4592921261588914, 6.788858712795816,
                    6.2153577684844, -4.859076656775282, 0.998008682741941, 3.74603340647436, -9.000929760983952, -8.95497975538451, 5.230939758209885, 7.057127969768982, 3.082518436312811,
                    5.081051377344561, -8.113335413534182, -0.8628298957255964, 8.64811414023687, 5.96103962564141, 0.29550567640794145, 17.140709699794595, 2.673651563050014, -1.300721736546922,
                    8.558424500970636, 0.7962293619185853, -4.126312716840374, 0.8712836295865973, 4.304337681301359, -0.84149517083064, 1.6391845231433346, 0.7421985514047303, -12.302354772551864,
                    -4.6045489107072335, -0.09314133200868135, 10.400763515696864, 1.4664222361538064, 10.472136802187679, 5.452538414016693, 11.420385142274785, -5.275782986244657, 9.969791783655578,
                    -5.4921638289883505, 13.816863847555794, -9.824298105835158, -9.98085176515193, 3.951420019157467, 6.291570011391565, -1.7619654809735241, -0.9568220445711237, 0.8110591064029753,
                    -2.76296401491786, 6.6790606452267545, 2.236857108315241, -0.41139659693805886, 5.3364371129662915, 1.4928867721769719, 5.838263567300213, -7.143867870407815, 2.8484017904210805,
                    -1.0517407836614852, -2.0713207817312083, -1.0376008892907396, -1.7581387046716102, 8.010953274533183, 1.736815112940687, -0.2340404449335658, 1.5065255245166436,
                    0.6018439563647857, -9.193636241404795 },
            { 4.271009555768041, 3.4769405896520613, -1.6535816371265102, 3.0792681493173353, -1.8474781030736502, -5.689755465002683, -6.39092482995365, -4.497529630285324, -3.8379009099178907,
                    -2.982161845541511, -5.927409840098552, -1.2098243756650426, 2.3940478065674857, -7.198202350970187, 5.762516302980678, -4.875566757669205, -1.8407897473730785, 2.9666276554937108,
                    -1.5688328884193399, -2.7823888940960435, 1.2797172061957696, -3.64138912533242, -4.410896944161956, -5.596601130326278, 1.0618373802712329, 1.977330948844096, 5.288834878690703,
                    0.4036439885330152, -1.5003715633414672, -2.6822409394424844, -1.8992550226175786, -0.7850266217799939, 0.6845311002241483, -5.153993634273181, -2.7205689163723026,
                    -3.5104905154621076, -1.3134537659093135, -0.7997631875024497, -10.94084752366403, 0.3800015467163955, -3.463333563963168, -0.04643380151022547, -3.309983944236298,
                    -1.067935197722764, 0.4775405392536265, -0.5527465808186953, -9.874487536662954, -0.119537367468453, -0.2505520452345047, -3.428267915369961, -1.1660304962313286,
                    -0.062010475301440104, -8.431923162943704, 0.24762385362216666, -2.0752582483204063, -0.5213099721533467, -1.1413289444357235, 4.227237071340931, -1.7087719118902638,
                    -4.3876507210903215, -6.831239858540894, -2.628878546203592, -8.709325815440977, -5.385295885937312, -2.3404270121503425, -6.193796814574409, -0.9153673400387389,
                    -8.101727677283044, -0.6890061366725114, 3.514447492241633, -0.4448413464787, -4.748133546443154, -5.284519675399477, -0.4831677838122388, 2.8805285701260885, -6.927013659272446,
                    -1.1576084585136641, -1.707617856868106, -4.9622603149611155, 3.0823475795779176, -2.464045006716009, -0.8291053120157047, -6.6589181136569495, -3.509173209698917,
                    -4.060814954421401, -0.35587621598367125, -7.393056945949807, -4.231455104724818, -9.928581391839373, -1.1718717793690627, -6.420107897999506, 0.9064867085701476,
                    1.6708393897956757, -3.990169206754167, -1.9104231992486937, -0.5744950752520134, 3.552653306599648, 1.184171364394102, -2.4827135800538267, -5.970555331559699 },
            { -10.625029986611741, 19.872500408127497, -5.5832079477854775, -11.692192692298654, 25.19164552080103, -1.5477833895702942, -10.980069936088444, -4.039463795396597, 5.332933669912041,
                    3.75241460942347, -5.54022349945258, 18.309824466257137, -2.596039224478134, -8.509447635743125, 10.622471869200846, 13.90749115029953, -5.234915206365721, -10.441569285082226,
                    11.244437779971888, -16.202211698454203, -8.883413258811261, 10.68269108468656, 1.5616484429242727, -0.29845449229679266, 5.201590760425297, 0.6928664601544627, -9.526070031559343,
                    13.434962926752563, 13.871385101645883, 3.8863678870183667, 2.457760485224363, 22.91940986111986, -0.40988595571212905, -0.25956991880808955, 5.3056128950729455,
                    15.176119480889003, 16.25916707368104, -0.25061339527225934, 4.804882325873306, -10.234108766086166, -0.7268511778546736, -5.438215353616538, -6.923386208870566,
                    17.051114664542784, -5.010131017351948, -2.685450436775696, 5.317808235763911, 13.628922849631259, 6.345722321247091, 26.66245142397692, 1.3893986511592908, 4.36243088398626,
                    4.512999921996133, 14.852650500707355, 6.57868753687864, 1.0187624344903778, -6.394179953436165, 4.235148263877351, 14.552082374749759, -1.604406514533237, 6.7722438998317465,
                    4.250347042946445, 9.75590269132309, -5.121309060359484, 22.98203216332316, -9.351945867550292, -1.2046184031272076, 10.420923523580012, 4.701453838099497, 9.456859998346356,
                    -2.368839149273354, 1.3881768826498853, 2.164349048983933, 16.04950107604101, 8.21232715044403, 9.15977428859037, -3.8119397369107837, 10.695501301403187, 4.066943891854533,
                    14.443290388277624, 20.016112202505504, -0.6803868448155743, -1.5680340972085842, -5.650052423827977, 0.7748642012919884, -1.35153228842317, 5.261230693430873, 0.7660596799277652,
                    -1.1693772355997911, 11.54895033576021, -6.308495159648329, 5.917607311876459, -1.5648112005424641, 8.514990274032044, 14.408655985317964, -0.6476808684450477, 5.988279913059107,
                    3.6496940253659305, -5.073765599896701, 4.202545522567005 },
            { 1.3902523423986932, 2.1789867660741855, -2.040302431128331, -3.7346372010627866, -0.04470440921742891, -3.058188610358827, 1.0627885428473798, -0.17128445879095655, 2.4238558880552397,
                    -3.455386911851072, -2.508534733673919, 0.554065485862929, -0.239937400987708, -1.3722172269289798, 4.88064094970788, -5.372536812516112, 3.8506550535517503, -3.514363392255721,
                    -7.622813076696107, -0.8832417661376396, -5.081058486897206, -4.886459265737977, 5.609909782404012, -0.39168435854789285, -1.0819321865332125, -0.496868454591479,
                    -3.719447409420005, 0.33530120026964183, -6.246134296740991, -8.420072528791442, -5.886904146608829, 2.4544084958992416, -5.36739639817303, -6.769090164885258,
                    -0.28351191776985063, 3.4457304453489837, 3.4728185317384668, -3.940824379409408, 2.7871423690563892, 2.38683691331674, -4.475807024656719, 2.1751707426184392, 5.797160146009501,
                    6.625589178596416, 1.8608468888559182, -4.091383265263517, 1.9581679198853736, 5.4212971638869, -2.5103564201507305, -0.9213272275227687, -7.345926709698018, -1.191984185006432,
                    2.0935245623174064, -5.57537967830798, -1.0373830168179683, -12.883101017151516, 6.564861736798697, 0.6996260057730277, -4.345168805036989, -2.6230269266874355, -5.079649681010043,
                    -3.471270806904652, -8.726776646766517, 0.6940593432242164, 4.072687835079224, 4.197960189617794, -4.432098660629986, 2.6042173035866005, -6.074123127378472, -3.573624737170919,
                    -0.4672042672659702, -1.554677261352297, -6.928966713972703, -0.8571622204118649, 2.84247435942041, 3.7340869824899467, -2.892342396267, -3.673407004627984, -2.5481041970725595,
                    -2.7509390057242378, -2.6695984810894338, -1.0564663632843334, -5.944665750617981, -5.554128202475004, 1.7431267892812996, -4.723837298990359, -1.5057628301676695,
                    -1.2170324908710848, -2.0540625457239594, 0.7379717664525871, -2.3280687877607806, -4.981090098182017, -1.761611573866698, -8.784613597761028, -3.4877840215506426,
                    6.379271574898019, -1.89903278752023, 5.759672463996259, -2.596061940193832, -5.350561482435776 },
            { 4.616127554356269, -4.268683604502977, 7.486580070173111, 0.45377163058516734, 4.731934776044478, 0.8901988625500183, -3.439164129492897, 7.523839781661151, 4.375798003832986,
                    1.6390416665586907, 2.993518113167376, 1.854792357124504, 5.165193850093795, 5.47005618766969, 8.685249390127591, -1.6597554335258993, 7.01953211530075, 10.586275708061617,
                    9.467356976070352, -3.6306637101415395, -0.44432167212822904, 2.8314930677079113, 3.998097434032871, -0.9591848065944086, 2.192275652694905, 2.0308551515080375,
                    -1.4468414894140889, 14.36723893327282, 2.9838238342338137, 12.095656330324076, 8.676370398770135, -1.897594743610373, 6.16338808538784, 4.2361438047003865, 7.78843699044279,
                    -0.7170808551760501, 8.03712786796532, 0.0947603577873295, 10.349361706232342, 1.6603715403881911, 6.310877460396433, 0.7781662292672222, -0.4001343424618726, 1.9825627382614424,
                    5.849623567392541, 3.9458415036552497, 6.681337235073247, 6.5039205963124385, 6.791594091018238, 4.227117450988662, 9.772246959672266, 11.978860916738649, 1.5517396616533534,
                    0.38241809710820185, -0.23664795408414374, 3.660949574240661, 6.190283895910666, 7.451047263767303, 3.295143966071267, 4.972294715943879, -0.2748318840775834, 4.321393063162526,
                    5.961534810622145, 3.4130827116666325, 7.461865359641913, 7.468492389242304, 1.8849068079465092, 10.723740584136479, 8.768935085461113, 7.423367715887519, 6.720723790293455,
                    6.483573856413158, 7.03374301179262, 3.565021096892513, -2.2069907323735887, 3.6066863519573693, 13.998207042173409, 5.288389942010436, 1.2793778505327316, 2.91478001820024,
                    0.6045879572638841, -8.774526589118972, 0.3996714579255478, 6.194013250088499, -0.6204304087825001, 9.9478003931222, 3.6425135063308636, 9.534200133469085, 7.615468768881742,
                    0.9445886048005052, 4.487539365358067, 4.961910608988822, 2.9383649110807104, 2.615303564115337, 4.006926345098961, -6.13519274093473, 4.2367749972722715, 2.5462034229527752,
                    -7.1700202022014565, -0.1905919775012368 },
            { 2.0001924392537784, 3.9324550448623232, 1.6725526183588917, 15.189201442816719, -12.399650973761227, -12.92273531080262, 4.330292747204201, -15.666154615104475, 8.491044226420833,
                    7.622272533037174, 14.972936370657004, -5.1803631106604175, -14.275921070397139, -8.201987007693882, 7.655194793410132, -4.98625449750466, 9.081348657481952, -14.205848163975949,
                    18.671093488079556, -7.188097420892525, -2.965751474489595, -7.91124978744439, 22.903014348720028, 6.160004121193006, -7.98325604980559, -7.669764276480432, 0.21322087011646018,
                    -1.4206599165846767, 0.9687402914377522, -11.973144100721305, 0.39221080678332476, 3.972350817869892, 17.434945044482504, 16.429550315280736, 1.7494370073675847,
                    -0.8086786979335887, 7.969922933046169, 9.260510555723506, -0.554970473962745, -10.228873602098707, -14.659336437909076, -13.106911573319895, -8.945994324974878, 8.005968874491419,
                    3.981372561259183, 11.427488889917704, -6.757267557024607, 7.96825255291485, 7.356306791794483, 5.728983473808123, -3.497842153849051, 1.2884546331191147, 9.783743001006266,
                    -15.679407334334421, 1.94618869984566, -4.086677774989385, -21.348964764415836, 10.654333024307514, 7.303168278626263, 1.4574445724025562, -8.583027868634662, -0.03266870683051659,
                    0.4151922253866997, 5.5687090856705375, 6.310182906936072, 10.305463757670623, 3.3714019449392825, 0.41455884425787615, 12.592945094106781, 8.035596011229103, 1.4874764566602812,
                    -1.6865616093551927, 6.987213737308768, -3.444411160138581, -0.574695415546179, 5.992023938862631, 6.581562935382681, 3.3010849986327564, 0.5691490805000832, -7.935380784346361,
                    6.966760163947395, 12.373544339314195, 5.8549748226670095, 2.196480927079725, 12.689886525023416, 4.713733029004905, 26.10771998712923, -1.5585672696719106, -4.844478501349605,
                    1.8311881389173577, -11.349457812496897, -17.17720348044517, 4.143046749013594, -14.189001342273215, 19.085051879391628, -6.125119056433548, 2.834874051771662, -6.29604239668436,
                    13.419439179767357, -5.281367050615414 },
            { -4.168362253191889, 11.29732161329024, 6.463414188271891, 5.535254773373131, 6.742937261970072, 6.186189798091972, -7.137354143390461, 6.4046688474305125, 1.027193865163495,
                    -0.27950027062349747, 3.80033292487441, 5.393356571288723, 3.3420409315673045, 5.265306161228538, 1.4372240687381534, 0.838457577898545, 3.341489919761023, 5.564637566288207,
                    6.780942004204285, 6.69632228795056, 7.394818283547611, 0.7059874377993998, 1.5618631298869912, 0.40271969885881065, 2.704065326589048, 2.674959253559648, -0.0367960507304792,
                    4.09864838903229, 1.0515560774991357, -3.595837540246883, 3.997064888316697, 2.997833206736628, 4.240580907911608, 0.30874068479877703, 6.171146283891325, 6.2140504815259945,
                    5.091147625841838, 1.0404711226181886, 2.1281052111257233, 7.081945066231965, 6.0987664561729895, 5.506948837915726, 3.8581535708247627, 4.651176209385348, 7.525892647281864,
                    -2.0615693985009775, 10.931666401163675, 0.5329078372723774, -0.005830936394457531, 2.4715031296915475, 7.416633068585088, 2.786663027337843, 1.2950899775694866, 8.133080216949335,
                    1.6016641727718328, 5.382325779775884, 5.311359521432519, 9.469640743443794, 14.453661608153165, 2.3718984228073365, -5.738584213013924, 13.731416256672325, 1.3318054064669362,
                    6.699945639791061, 3.183142182189, -1.1028115408058898, 2.0378873436063163, 3.350064205969272, 6.26404795400304, 6.789961721287542, 6.00380521386708, 4.459563486310516,
                    0.9162601307290545, -1.719197050177943, 7.220649865634439, 1.4708596415440618, 5.0661970600913815, 3.506077066424659, 2.247315073241862, 5.057296320654565, 6.39894010759912,
                    9.403788009272713, 5.335514198191249, 5.983697534610394, 9.609412926945708, 5.267351356241603, 5.913907255219686, -3.3078263794390317, 4.433282771622569, -4.682835696670546,
                    4.5490924027721515, 2.3510736482718064, 5.977020359400356, 7.362721483473093, 6.322832597315086, 4.8483036393257155, 3.08290234387035, 15.054557073064634, 4.417468748506312,
                    3.7831217586020873 },
            { -5.45830354054558, -3.9716271702407457, -12.290782110017087, -0.9127435861356412, -5.568614727279211, -2.931481397981864, 2.2590812516017196, -6.2944372618993025, 0.23714733309061442,
                    12.08939964066685, 7.067516536579969, -1.0229479402421062, 2.156983403105922, 9.44240088315929, -2.3875876872065644, 3.6573770982358855, -7.878746803308253, -12.219253661554703,
                    12.761479389876115, 2.2233315776653835, -1.2913871719845642, -7.333879606222769, 24.018814545939406, 4.522297026585151, 5.984404399230478, -5.062790533038021, -0.09913565027003601,
                    5.102499147017792, 4.398650650460466, 2.246108098432555, -4.396362183089442, 4.341374470778301, 2.4541682075258864, 15.904152970229122, 2.40528618281777, -6.906823702064074,
                    -2.222154498491573, 4.906892271137677, -3.885423929657142, 0.01041245093913945, -0.19954798594414225, -11.436713439852952, 7.886991079361603, 11.1775330148781, 3.9173410914144857,
                    2.39025547165266, 9.638771610196084, 1.3920736447005084, -5.360460235174926, -14.422591513913094, 15.811688927160983, -12.541212557218184, 6.114882071273334, 6.696369439519537,
                    6.998588616260328, 11.076815787460628, 1.2563821751564554, -1.6350906191502008, -3.928586261889543, -0.6825020411675307, -4.079664564465741, -0.9543174193605486, 1.668028450336639,
                    -8.871351203406675, 8.270066163198814, 7.03231686241603, 8.786279331956372, 6.182083451476602, -7.3179965627246, -6.300148185115242, -7.156068677605836, -4.499925913507398,
                    1.0088614664217923, -4.3825279755476485, -3.158813046844606, 10.974566716747425, 8.205119203335698, 8.350654834499196, 1.8380630046686692, 2.445146543515334, 8.433054937008688,
                    3.3183114456778093, -2.5656694075175306, -1.3000692491602663, 8.834420381953898, 0.08053296358489237, -0.32068259434909496, 15.534097732412246, 13.09748336859736,
                    10.780648026499879, 18.374915024660186, 6.4517150629613305, 14.783938299982104, 11.553487222294812, 4.371012778498205, -1.5077843934248416, -10.214860707016133, 1.6986975798961177,
                    10.67375210826217, -11.419556609159544 },
            { 1.7162984575011766, 21.797080864695097, -7.124570122519129, -1.3880550504537479, 6.8647108300455955, -1.652626521058031, -4.35190366117432, -9.323918178032232, 1.7455089811066833,
                    8.845649672446417, 12.664296099820042, 5.027170563862112, 3.021386416408075, -8.176392511021506, 2.9311875967602896, -6.158671438549554, 11.831637382982652, 22.074650309513018,
                    11.013122339890305, -1.4337815511025824, 11.535242640573811, -4.78246617465498, 14.225800555725224, 0.002364191636788693, 7.040076139330208, 6.5839635960058285, 11.603218837135268,
                    9.119975434711577, 8.416780597647048, 9.135621215992096, -9.118799324137958, -1.9304248007215157, -2.3100911545939518, 7.003100226138377, -0.01694827477222871, 11.363445015946658,
                    3.931925192230079, 7.6586876354102955, 26.425323911937816, 7.985777777948802, -7.8978665363312235, 3.0542152643764915, -6.800491653489354, 6.784332799216441, 4.187187362497628,
                    -8.034310883861089, 7.14500705428478, 0.3764878170035202, 7.773654025846672, 0.26151315355432025, -0.4592097583570953, 4.617227355098263, -4.527153367416515, -10.198861167588449,
                    -13.945332716310308, 14.565620965786284, 1.1769644608263516, -13.540399495833586, 6.953680405338093, 2.3927577778910023, -7.0227437734917135, 7.244283638084303,
                    -0.04357055633939666, -0.11526182085148529, -1.0291287561899565, -3.6247404883416108, -7.372088555156431, 13.103490812884461, 4.255299219217061, -4.796121689535574,
                    -2.2248420902606885, 14.456701568817062, 10.33625597901413, 17.57129376330769, -6.953261807871932, 18.620253343601142, 14.114228317584157, 1.1784401971928133, -5.473888709223386,
                    3.672067989892132, 2.1608991199639824, -2.358524771331364, 13.881714369419834, 3.7257935834974596, -5.82540909493154, 8.668104806321, 6.839460279449347, 12.93408141363587,
                    2.893981392789838, -12.038085059628411, 9.196606357849433, -6.318025526635584, 1.7733720000768904, -15.100900837581047, 1.1779036569045056, -7.902711491163073, 1.3278783091725241,
                    4.372601269033138, -1.4218852669294466, -1.7802708119264863 },
            { -6.690098027825138, -3.5319770204337466, 1.9738961616499537, -3.9336090374794184, -2.248606346802141, -1.0745290063592163, -2.959536521079502, -0.08082332959139715, -2.1233679064896345,
                    -2.1769512020948802, -1.4974514787896334, -1.9646352168885444, -5.297202931206246, -2.911640322736597, -1.455750585197528, 2.7036205812636886, 0.2284777138647882,
                    -9.643358658920139, -3.3111248862745577, 0.14967053773811645, -0.5932869870145652, 2.4686805670751686, 3.655171803782972, 5.234789534153324, -3.9133477210664176,
                    -3.636442654131558, -9.945013312757208, -2.8540257566379728, 0.265634658332059, -7.2432186590368035, -0.8356158822603007, 2.8006175674125915, -0.4946723677632654,
                    0.40868549005617427, -1.6951551664219404, -1.3010359048578872, -8.362547150621864, 2.581220000825347, -2.8175014171489856, 4.748496970635325, -5.655985444346958,
                    -2.542561168479798, 3.693863962684369, -6.052063429851295, 10.880271199048035, 4.162165578196637, -6.568434194558587, 1.8054236100031629, 2.198711904866065, 3.6300802612159853,
                    -4.0921402320230635, -2.3089771000025507, -2.4926604849468523, -2.013272980972482, 1.5199107858950813, -2.0212911754346314, 5.0888696235593995, 0.5224361133345115,
                    3.4775448429208913, -1.4231333320007606, -1.718404282037977, -0.4755055387051368, -2.6747791073062004, -5.651570348987951, -1.0434804937186248, -0.17464409824640503,
                    -1.9322335383030045, -9.067213958116852, -3.22692236052125, -7.787067960218135, 3.8806381330226447, 2.7667382715880846, -7.124235719234259, -7.042656531795917, 0.21576831608640523,
                    -1.8560949617775861, 1.7923381001836187, -4.878214167342023, -1.9589090972007983, -6.528093576569837, -6.079931110552723, -0.003533568275536414, 4.855621954112645,
                    -0.26595660827346745, 2.8402964613360293, 4.065191787447191, -0.3066985070851018, -5.430706372499246, -1.0837097576205803, -5.662313226926714, -0.24841139326266926,
                    2.0787269371027306, -0.5198385462266664, 1.0684187323315593, -8.306221422898094, -10.651233710339534, -4.83199083923678, -7.772583876036121, -1.853759567627876,
                    -2.8992190604858914 },
            { -8.790152480783659, 1.8748865688661467, 21.82037174556815, 7.277827029880069, 1.8669273125207657, 6.093360077619325, 1.7281177981308224, 22.010531934087187, 10.376599377567253,
                    0.07262422859863582, 3.329287697229775, -2.868311097079063, 12.556538786028675, -12.652444395585366, -14.566603955744085, 14.954754484501295, 21.64647728991765, 5.410543660941253,
                    1.9840772165822707, 7.23150762821031, -5.337750214321417, 2.5478739343315744, 1.2726123688671642, 6.93563001498327, -14.116187965319588, -3.988441599082752, 9.040571613928122,
                    -5.612782469176494, -8.674989992215643, 20.576352510383078, 1.2649926327145335, -4.681154868479992, -15.411080015728402, 7.926102794117288, 7.634978418524221, -1.9813713541761566,
                    -9.724118224833099, 0.6610900063786946, -7.157169993770802, -8.18094142509995, -0.09695918998702091, -9.234194079432418, 3.274527790870608, 6.756661059723105, -7.193561558553586,
                    -12.28760479621994, 15.943133742374867, -8.163370452056805, -5.461958429776417, 2.950430775933889, 6.673563100784002, -1.5723667934221632, 5.338166998496016, -2.9664906184735376,
                    -8.461146377884987, 14.642548094089829, 24.877848814057664, 17.241090479038697, 2.2642014333778495, 18.56579747961294, 4.3254459787628985, -3.7017663889222305, 5.391989940840266,
                    -0.011961773050199298, -8.576280168533533, -7.759130648151096, 8.626737586131297, -16.89667740810621, 6.719504450088846, -14.806026670979792, -19.543323824106473,
                    -16.822616283220633, 19.85063564442394, -0.9933699836776222, 1.732033524049594, 14.57449601391356, 9.900006012371959, -12.511754431720052, 9.271954172074249, 2.6725499197058387,
                    -2.394960927381927, 1.131746153669006, 13.230735507145935, -7.640065398011766, 4.760849661646009, 0.8046004677767984, -16.420942483531185, -6.833351400970257, 2.759590720691902,
                    13.39966624883221, 10.547117783454471, 6.6527781659293135, -6.958844281862677, 18.255292126294222, 2.9718558921091414, -8.800306107000166, -0.8649235276820364, 9.534475976672109,
                    0.9710706545118187, 9.444048380570173 },
            { 10.750459182049635, 1.2683188634949563, -2.52895039427273, 15.745350399538385, 4.879921763799344, 2.5668212504364822, 3.8246260105153325, 8.983681822951544, -1.4653214229051983,
                    4.720355494655534, 5.522506013055193, 0.24793556539992778, -0.03154598906074213, 8.718963403711582, 6.8941913972595295, 4.300679848013637, 0.660213834123176, 8.620479211170215,
                    6.567356399678622, 3.401961040063919, 8.137371205831437, 6.914462865496031, -4.2870994722138285, 2.053900824448916, 5.78512120057684, 0.030408423778063742, 6.431734093150965,
                    5.192917785672797, 5.923368990889981, 1.742863232902769, -4.203991750669209, 13.583214744980976, 6.948274200266266, 10.538568248127, 3.504444628952374, 0.3760140953015103,
                    4.860843944098749, 4.650234535858198, 7.421363874265881, 6.3588396798327205, -2.7003389351409712, -2.6344920880591776, -0.6860958598269127, -9.454499064850754, -3.8099579798027055,
                    3.1745666037984, 3.067420024453921, 4.317808756556711, 0.39190644682179343, 1.074539685183975, 8.266163844312908, 5.379156905927105, 12.818110631333616, 8.229612634129548,
                    0.08829702623615177, -0.5500493564991311, 16.638408539042803, 4.1248198009790595, -2.966672429554005, 5.707527376705064, 2.6884884114702503, -0.04073192306337603,
                    6.308939397671263, 10.229979681338346, 1.8792121314817338, 1.4125803304270401, 3.378120931729963, 7.9078659725740446, 3.80937034483583, 12.037867359663274, 3.5229850507217586,
                    -2.7655063257286, 2.7425574831769834, 0.23237624566586224, 5.210294223602379, 0.527736122054169, 5.748867769383509, 1.4725676619120742, 1.1530723820958033, -2.4761910000818093,
                    4.10508951038077, 5.962775414061075, 1.8878786520064899, 7.8894679082804995, 9.971415536441867, 3.7501711873494026, 1.0286631568585438, 7.669837818152222, 5.69736042144962,
                    -2.805456196791333, 7.586456430776864, 8.062572826067719, 10.173124681597416, 9.587995667981417, 10.020791816584843, 1.007381142585864, 10.113034779946839, 6.3846899537540995,
                    5.8168300075971855, 2.6373507834260836 },
            { -15.708445270648578, 18.219881339008715, -2.5413743584757498, 6.155960086165234, 2.3510425504207486, -1.5642131705128044, 17.14301630005845, -14.983943906662882, 3.776255961810589,
                    9.673216883332424, 0.6099513339983846, -0.24110418279488055, -0.4773646851249769, -10.932611357905023, 1.2650830620140145, 5.838531500204567, 1.5587288691604506,
                    -1.7261597325413218, -3.8216340095262558, -1.7938143332174548, 13.01807630630233, -19.21046058432615, 1.2838173642792001, -2.2607884237585787, 14.926742756202357,
                    1.4324215715131412, 15.207338675756352, -19.569473517965708, 5.326512240707831, 3.596476964977154, 14.297721672747123, -14.919401653291308, -0.5963586883402003, 1.5342618022638579,
                    -3.8801328892361573, 12.621370039833465, -2.3660904376503966, 20.505912561293158, 11.056383597810786, 10.060493912258744, 6.287419663463471, -9.352774635866597, -3.256651206537059,
                    6.41705529260156, 7.427028473778218, 13.49450758627148, -3.6068912771369543, -7.391314193770118, 9.176530839715067, -6.9044061524801785, 9.313444607196296, 12.459074416308589,
                    5.293440597098188, -2.548192310503512, 1.2935577744713223, 6.61667372341933, 0.9958177107300529, 22.08182684116306, -8.649063177624885, -8.764680127786466, -8.516313391082903,
                    -4.783898497021118, -20.09988797699937, -5.1700430258203305, -5.39779773259128, 1.6542740823118771, 4.923852293451061, -11.053839323673914, 9.571151221764833, 18.265200882452827,
                    -1.1095023142597196, 16.069292987529245, 2.81525131483001, 20.062332565639366, 11.664508348010322, -14.173102915762497, 1.0771686942619136, 11.057800817750357, 1.1920296860326296,
                    0.542230808426116, 13.13391370468576, -5.9429367472632135, 1.0664551023735005, 4.016324636862733, -2.318955522908116, 0.7036869818475395, 8.366274232849134, 5.068758631771775,
                    -6.895646033391832, -9.742368020969222, -6.706620193497107, 0.9096945634529018, -0.6436165139010692, -7.119600885393371, -4.866489502731829, -13.750388876444017, 4.924364191217799,
                    0.5120181064970657, -11.242437829963873, 1.1734688006632374 },
            { 7.003769270481142, 8.091280144593798, 4.535402980154294, 7.306729286691006, 1.6631851815626342, 8.809064299169655, -0.44474353450701454, -3.05860113614348, 0.42137912803409794,
                    3.4320436823444282, 0.25916058362884176, 4.495376359137075, -3.394429745641925, 2.5051225671605133, 6.167312588862295, 2.037837986980777, 1.0574845970535658, 6.274501846902817,
                    9.604079853867958, 6.709134468441599, 3.316566449431068, 4.965611639004887, 9.285652174145834, 8.58201396942984, 4.414111777928125, 9.27073303477281, 6.591928739074721,
                    4.112389123822614, 5.510119521061812, 10.39413715786661, 8.329553076286693, 2.3286397462243418, 0.4221402337643667, 3.8791030145060317, 8.970401443851674, 3.738028623959,
                    2.9702870928509344, 4.161780433136874, 6.200531211814257, 9.436419968673999, 15.717488390384661, 4.133539876369654, 7.414218744595534, 6.380479260997568, 12.965025572034074,
                    1.476117648582314, 5.325453155775522, 11.148175396032634, 2.9827456237411862, -0.6823995293881406, 5.287203364546662, 2.1056448846825653, 10.32342047589189, -3.567057707215038,
                    6.02233796390365, -3.8941938639402416, 8.9355452639709, 0.4309847362877317, 1.9574783783368215, 5.184961352379839, 1.2365871738795113, -0.2698250487569327, 4.57917791936686,
                    13.847750709957563, -3.880525183366194, 6.894462442681161, -1.38703562982902, 12.38528809685962, 6.822412163647883, -0.533420795717352, 9.804685142449117, 1.8693012296735705,
                    5.437296182541722, -7.290483795899988, 3.159266109214194, 10.616132814863688, 10.12486613267501, -3.7757220905428053, 9.02742147050105, 9.57569180838957, 4.266016173661185,
                    4.384618108920472, 6.344118959076706, 3.285396921408836, 1.7560775929708239, 6.874361824920792, 11.19913123291149, 6.269078568361784, 0.5049606705163092, -4.2044179669848685,
                    -0.3973484491166994, 15.080137711909101, -4.013089023149176, 0.9565529010324196, 10.181666459939812, 6.628967538541518, 9.614562493604499, 7.9812303357837475, 5.477424328254116,
                    4.518195262558667 },
            { 3.62154090414355, -4.188257264288853, 10.73985965024838, 11.998248028956972, 5.50904756553105, 1.449616369619344, -2.0070748834458003, -3.0701933917116184, 12.026462849406107,
                    10.111893573862488, 0.565084270164206, -9.228408203142132, -17.31552787054458, -6.021518939495168, 0.13260063034966452, 10.023238094384029, -3.2327390131910523, 4.236843392900371,
                    9.393439192439159, 1.806478582272414, 0.05620767985045427, -7.476956413884963, -6.790447148226066, 3.6638331217301756, -0.3213798511057282, 1.7676926459321742, 0.6709060960720443,
                    5.265937395636525, -4.091979717851423, -1.1912255429483776, 13.223599466304094, -4.189501506410338, -0.8424090528334407, -2.8305439327308015, 3.8490867143525933,
                    7.5798419016452865, -2.2416494365152895, -1.8102097535739703, -0.8256556866446318, 4.39843529504958, -3.7994406526582507, -1.4520332091492714, -14.345590488084067,
                    -7.948339595373923, 0.2500024779068787, 6.775521916600061, 2.8821471919785475, -6.120610699300945, -8.067902337602266, 2.1045185152751333, -9.699091347315898, 7.861028650237568,
                    1.3889718188887847, -9.405316208079888, -5.262769030653339, -3.702014092642762, -4.017734827658999, -8.647119510193061, -4.673123660179803, -3.444239282301103, -3.6178827440230084,
                    8.261675516936542, 1.6533466858645958, -5.439119816492332, -1.1850311753602827, -4.704737434047695, -0.9614552708184001, 6.631132158046425, 2.605672199507512, 15.738833558218214,
                    3.404363190981673, -4.924583078695804, 6.20633778997993, 7.9514822352392205, 8.043430263401472, -6.091367819871634, 0.02268870951134272, 8.286576878685995, -9.905295087949456,
                    -2.249433380563021, -8.240236428756043, -5.047146136570494, -5.563131068348032, 9.05362700673208, -0.5385972818313427, -4.6000927961724845, -5.712646375046844, 1.891289956600143,
                    0.9043457171000852, 9.65756733979963, 4.205848481439219, -8.271627480994768, -3.086279284110505, 7.887805439557419, -3.035266503182277, 12.179769643270992, -6.117516702813298,
                    4.674746016470547, -4.5862704816697555, -2.315174885628227 },
            { 4.84182031107145, 8.058469995512729, -3.350979821766689, 6.31696348802519, 4.497185408452083, 2.879691971715661, 10.246431483401626, -9.820678940302354, -14.361466413828353,
                    -6.328618619990058, 0.21687394988696662, 3.0098500074396557, -1.482194175974739, -7.479101334970075, 16.266891321568007, -2.290717553635424, 0.47077851343287286, 8.273902774468445,
                    -8.419501076199603, 11.598916106841122, -0.9499166235041543, -5.0136067718978685, -9.454844224205209, 9.98870166688559, 4.2070642350874285, 5.010966806943568, -4.6805537541264925,
                    -9.191391179819771, -4.281552107109304, 7.477363345637327, -10.675222712926976, -11.520682987580557, 2.2170645414024523, -6.270401768080252, 16.81003573229094, -11.422676057424434,
                    4.95483111646561, -1.4156805370140164, 2.859183337637881, -8.80737901898156, 8.304935967733552, 15.44167497160674, -4.620378059682937, 18.254787844727154, 6.644996445008065,
                    -0.7806863782541795, -1.8754866937386363, -0.11875162667035699, 13.643895874979043, -3.4555528672938385, 4.052952619840799, 1.9112729054863655, -3.4062734800533674,
                    -20.81468098716529, -8.538759869562142, -0.8618897069264229, 8.880703629415507, -7.412642748653004, -9.934814284481954, 4.74809980333762, 4.995746419141706, -14.529755580801615,
                    -7.552824869087971, -3.5423721552252694, -1.6147249699663186, -27.540885023592544, 8.636808833121705, -3.475498315317923, 10.66928985703444, 5.674418376059627, 12.424735205623652,
                    8.016840519781063, -13.088768533839975, 0.5622113361581036, 3.6750436921728955, 13.592889579990928, 3.877739000509206, -2.6258611969622403, -0.21822588346467953, 4.224133396721374,
                    -3.658870777651119, -1.3520080125274614, 3.7789042408337754, 1.9302964068764494, 0.4559029732793645, -9.937924234003134, 9.076855649603734, 4.556985404449269, 8.809236968264656,
                    -2.5222184855762486, -2.076746847246544, -3.4491698378510742, 1.0886990718933145, 9.913182455758912, -3.397359605197125, 1.9035232809269778, -3.057967302072268, 10.182890848285156,
                    -4.199983043477769, 12.251991723006494 },
            { -0.7547893348646062, -2.2312931131021685, 9.607909758005649, 0.2009315376685763, 3.9568703915736, 0.6760510280447296, -1.824031833522457, 1.221684092642763, 12.047227616728147,
                    -3.9838646668598825, 5.930216246494058, -5.650650359341424, -1.9924300541695237, 0.9994137948662047, 3.0843075696091447, 10.555710575835628, 0.6527892456587807, -4.472593460980619,
                    5.174852914943756, -1.3758812788064634, 2.517900294170235, 0.225596183509702, -11.57640331390569, 4.259344595063724, 4.7442096921195525, 6.961155728446706, 12.605353069234399,
                    -6.742834839291561, 4.3123612547134185, 3.619882366926794, -1.7305558419216553, 3.541155882396172, 4.203460347731481, -6.8951370361714766, 2.5666083986611365, -4.952936512813115,
                    -3.23403268014754, -10.486702204712701, -2.081140272831855, -0.33858090443095534, 4.527763214706619, 0.9820826519370929, -8.985278293993222, 6.544833623880543, 0.21032605815193195,
                    4.130626972080522, 7.215194603662267, 10.164790404344172, 13.643719746729543, 0.5096841889337631, 2.9858045601766454, -5.988800724640463, 7.833083081109858, -6.676848172408503,
                    -10.683744304353796, 6.339684402769454, -2.3933370641647636, 5.998789731513696, 3.6120002155907986, -9.55182108724607, -16.589978829901927, -6.106616049711479, 1.0827876221130532,
                    -6.915111342088602, -3.2398776951654247, -8.446942213513292, 2.073501820272571, 1.562909394412336, -2.1330165409142685, 9.9998326154289, 10.649923270518215, 4.627297662826004,
                    -10.648346031217413, -6.158858549881914, 3.6059009195219813, -3.0835463294875334, -2.1698248041322645, 6.782647558579472, 4.275980478289384, 9.464316203155237, -1.7959675012279028,
                    9.858770110609175, -2.602831025035045, 10.661397339288245, 1.659849811252344, -4.581711720399234, -9.559680692582567, -0.9709218556709551, -0.6787218335579086, 6.515857866042448,
                    0.2619725312974691, -1.8167826141093428, 7.932791711836512, -0.47587144530761205, -2.745641889491452, 4.687635248495274, -2.1875015511272586, 5.231434328489028,
                    -2.8791824063486686, -0.4638101588007002 },
            { 4.4648361343772915, 16.17619190635662, 1.774146303547799, 4.48896478810274, 1.0397807894018638, -0.7504218618014473, 5.241767861662441, 0.5153872219323743, 3.1994761217909966,
                    3.274432596602002, -7.9891024487561335, 1.8523589897920671, 5.521216682897144, 4.6588293938738685, 4.258901390850791, 1.763290815978574, 2.0311854950574744, 9.015888922893307,
                    0.24228419760951514, 3.3418383274279515, 1.467783343013724, 4.481139800156732, 8.886540792527413, -1.1110697374768073, 0.6194316214393742, 8.269073985053097, 11.131282957750035,
                    15.927986082871186, 1.2195698773993828, 10.76146280692489, 0.9320289696714195, 2.769651755389459, -3.8944389705610014, 1.6043689106135721, 2.282982222178826, 2.480666994107055,
                    9.041493728066396, 1.5382977229982173, 8.455147700813619, 3.4426142406638105, 3.4906676408255044, 6.86558041191675, -4.990806962359581, 3.6347468239838236, 3.3295757341222605,
                    0.3964105230599855, 2.726582132196609, 5.338601226987189, 7.4486525616260835, 3.4739574820877936, 5.219496523584754, -0.3281180486531028, -1.0799361789997208, 4.872098419389928,
                    5.800922559746832, 3.3182500459468303, -4.055233416022421, 10.091275393981867, 6.891740384935938, 6.354943178198146, 3.2467216286595417, -4.267871882925959, 9.524588460547825,
                    8.933931729602216, 1.8513886968004014, 3.1016064595953257, -2.751067388546711, -0.6431828170209659, 3.409049134882864, 0.8660907573184389, 0.9491368384161643, 9.393109765629099,
                    0.06620969130934817, 3.369176758530652, 5.573905642027443, 10.184212794998793, -6.996671046513583, -2.384263833165594, 0.9321720687448507, 0.31673960383335853, 5.434490085659284,
                    4.39949493464202, 3.1427367312033323, -4.63159478204552, 4.7161440826169905, 8.839226916441667, -3.225999502292753, 9.358787467740811, 13.141305826043187, -7.32052634831337,
                    6.475314619911093, 5.831607626836169, 1.6494819021483287, 12.967960837576173, 2.384139848791426, 6.6932988056192215, -1.5103315402428352, 0.22006271086037366, 11.181454862442031,
                    2.248488723114191 },
    };
    int nReferenceCols = cols.length;

    // tables of expected results for col_i against col_j (computed via https://github.ibm.com/Dublin-Research-Lab/mat-base/blob/master/demo/metrics/meanshift_test.py)
    double[][] tstatTable = {
            { 0.0, 1.0672762676396055, -2.4364107583330115, -1.8832626116127404, 1.0506475702755214, 4.937395246516001, 0.8365704090933118, -0.16865647544498, 5.458635252531385, -1.7023041209440966,
                    4.287587111889207, -2.827870835300019, 0.513290783358859, -3.062728232765329, -0.12725973351412462, -0.8959098158332477, 4.5743379690867085, 0.10957762135937045,
                    -3.1119293708906817, 0.4623669163101819, -3.847488901952086, 1.9872843449972717, 1.2649831272686793, 1.241905254598443, -2.2205956182513735 },
            { -1.0672762676396055, 0.0, -3.680624924008994, -3.161915414245844, 0.22364367147605083, 3.751362942724765, -0.0336269860138488, -1.2438704553763082, 4.244389652240965,
                    -2.5715408552902095, 3.086534149295548, -4.123963831374583, -0.3111313017615634, -4.41185386402613, -1.086358560506406, -1.804400586328332, 3.3794224706993727, -0.6787096862631289,
                    -4.385723715300988, -0.36745013438992363, -5.13258862065952, 0.9641392777825224, 0.37105179122236903, 0.17602352459404313, -3.4682700266542907 },
            { 2.4364107583330115, 3.680624924008994, 0.0, 0.7471606957753364, 2.954008747158361, 8.963866419058409, 2.836589726385982, 2.2626274869881677, 9.835522162219911, 0.046336993967459404,
                    8.204034015495086, -0.364648762837253, 2.36035291294186, -0.5461282614069768, 1.9998624182926643, 1.0190887006707061, 8.542430035477471, 1.8313789714383482, -0.7515728624646947,
                    2.318695735343612, -1.6139167572556208, 4.60724240376844, 3.3782029780946603, 3.8807398930698636, 0.26686415827163223 },
            { 1.8832626116127404, 3.161915414245844, -0.7471606957753364, 0.0, 2.5390375288503186, 8.63845539428694, 2.397756603495705, 1.7002979013802515, 9.572952772214794, -0.43460080744100854,
                    7.836911218753712, -1.168389876525536, 1.938252680659048, -1.4048746021635854, 1.4979021733132032, 0.5289564224641635, 8.19402211902889, 1.4217726514539801, -1.5496079870977542,
                    1.8931384500093866, -2.4516855232020305, 4.134083585631304, 2.9366829511333234, 3.368465276041657, -0.47381376142504056 },
            { -1.0506475702755214, -0.22364367147605083, -2.954008747158361, -2.5390375288503186, 0.0, 2.4418963805920795, -0.22338688911787913, -1.1864650241554748, 2.738200480826251,
                    -2.3483059202436958, 1.9629142310541159, -3.2377062515408306, -0.45090141636818387, -3.39733705948694, -1.0854973380580493, -1.68807702604717, 2.173207866882841,
                    -0.7631401337621757, -3.455841810463986, -0.49883317159491847, -4.005435344920185, 0.5343777346816817, 0.10585396353509212, -0.08787455481633125, -2.7915065706044238 },
            { -4.937395246516001, -3.751362942724765, -8.963866419058409, -8.63845539428694, -2.4418963805920795, 0.0, -2.8909971518549504, -5.17551047637298, 0.4758133516618378, -5.599259623773654,
                    -0.871946292567152, -9.861649383148395, -3.0012654063293196, -10.633932321017808, -4.4185795202371025, -4.958485551462412, -0.4898449135890238, -3.247115399239452,
                    -9.978581200433213, -3.0829526710150965, -10.903028436118749, -2.4653239066815056, -2.5535588194554126, -3.547935462509953, -8.750950351098394 },
            { -0.8365704090933118, 0.0336269860138488, -2.836589726385982, -2.397756603495705, 0.22338688911787913, 2.8909971518549504, 0.0, -0.9785861731983444, 3.218365295792621, -2.206445673705979,
                    2.383097324243634, -3.138214962645348, -0.24461339627314205, -3.3095907545283265, -0.884960788850389, -1.5181125689667814, 2.606251254220393, -0.5740313617855674,
                    -3.3681040856609683, -0.2933369390415972, -3.949683988499305, 0.8233148711884307, 0.3473968242549808, 0.17640739805382244, -2.664834746042749 },
            { 0.16865647544498, 1.2438704553763082, -2.2626274869881677, -1.7002979013802515, 1.1864650241554748, 5.17551047637298, 0.9785861731983444, 0.0, 5.71047832195859, -1.5725310201121645,
                    4.521493092223077, -2.6514526645906766, 0.6462585437967417, -2.882579949885111, 0.023793995779045157, -0.7566651859371121, 4.810226361475347, 0.23504679006508147,
                    -2.9405299076363103, 0.5959818276679922, -3.681169355993277, 2.162983287393847, 1.413234439651805, 1.4195990034270722, -2.0445281077922433 },
            { -5.458635252531385, -4.244389652240965, -9.835522162219911, -9.572952772214794, -2.738200480826251, -0.4758133516618378, -3.218365295792621, -5.71047832195859, 0.0, -5.965001997902728,
                    -1.4043846797439887, -10.865140157449018, -3.303792189219129, -11.791797244658332, -4.8323923615922935, -5.3430976071301695, -0.9978128923388084, -3.532980936679062,
                    -10.934510502665026, -3.3896161478842153, -11.904139685937364, -2.888563374401368, -2.8897991459908474, -4.034567893201614, -9.624260654931957 },
            { 1.7023041209440966, 2.5715408552902095, -0.046336993967459404, 0.43460080744100854, 2.3483059202436958, 5.599259623773654, 2.206445673705979, 1.5725310201121645, 5.965001997902728, 0.0,
                    5.110984415836337, -0.2823632616285389, 1.8756115360155012, -0.390412755314782, 1.4797291263363765, 0.7590805243120635, 5.326149753076169, 1.4755914361405555, -0.5389819211010917,
                    1.8372899934277052, -1.104698294233646, 3.2918918698692883, 2.5969634816944667, 2.712064269703533, 0.12938356796602282 },
            { -4.287587111889207, -3.086534149295548, -8.204034015495086, -7.836911218753712, -1.9629142310541159, 0.871946292567152, -2.383097324243634, -4.521493092223077, 1.4043846797439887,
                    -5.110984415836337, 0.0, -9.06403337212659, -2.5277785884601127, -9.793276773018073, -3.8545073534976124, -4.43758268038222, 0.3827647891106965, -2.8004976434756124,
                    -9.20602851959541, -2.6061156471943416, -10.134755741037285, -1.825633167975113, -2.024811804662633, -2.881757080971124, -7.984058639017171 },
            { 2.827870835300019, 4.123963831374583, 0.364648762837253, 1.168389876525536, 3.2377062515408306, 9.861649383148395, 3.138214962645348, 2.6514526645906766, 10.865140157449018,
                    0.2823632616285389, 9.06403337212659, 0.0, 2.629942610207876, -0.17287817083238907, 2.320832752620339, 1.29160370080631, 9.420262581909716, 2.0753761040104095, -0.4157923363366279,
                    2.5897315730457655, -1.3199878692084621, 5.057908133986295, 3.7060167356937135, 4.331784194926644, 0.6469836071705186 },
            { -0.513290783358859, 0.3111313017615634, -2.36035291294186, -1.938252680659048, 0.45090141636818387, 3.0012654063293196, 0.24461339627314205, -0.6462585437967417, 3.303792189219129,
                    -1.8756115360155012, 2.5277785884601127, -2.629942610207876, 0.0, -2.7763304034322647, -0.5832558947356611, -1.2022563702390223, 2.7357792050949716, -0.32610864626717706,
                    -2.8527689580452367, -0.04570019208790191, -3.397428300056941, 1.0531519593120247, 0.5818322689025421, 0.44605218656181583, -2.1975637845585387 },
            { 3.062728232765329, 4.41185386402613, 0.5461282614069768, 1.4048746021635854, 3.39733705948694, 10.633932321017808, 3.3095907545283265, 2.882579949885111, 11.791797244658332,
                    0.390412755314782, 9.793276773018073, 0.17287817083238907, 2.7763304034322647, 0.0, 2.4994164468197426, 1.4295629300740555, 10.169838967831584, 2.2019905957559596,
                    -0.26980781330087367, 2.7368037599210866, -1.2202750266555644, 5.358481736640865, 3.8998605735408263, 4.62775317926946, 0.8442841381757844 },
            { 0.12725973351412462, 1.086358560506406, -1.9998624182926643, -1.4979021733132032, 1.0854973380580493, 4.4185795202371025, 0.884960788850389, -0.023793995779045157, 4.8323923615922935,
                    -1.4797291263363765, 3.8545073534976124, -2.320832752620339, 0.5832558947356611, -2.4994164468197426, 0.0, -0.7179700615632923, 4.102960697633316, 0.20203188900357125,
                    -2.5832085015300676, 0.5358471467684961, -3.228090980969453, 1.9190991827753285, 1.280357304295228, 1.2429556207920929, -1.8073723757781983 },
            { 0.8959098158332477, 1.804400586328332, -1.0190887006707061, -0.5289564224641635, 1.68807702604717, 4.958485551462412, 1.5181125689667814, 0.7566651859371121, 5.3430976071301695,
                    -0.7590805243120635, 4.43758268038222, -1.29160370080631, 1.2022563702390223, -1.4295629300740555, 0.7179700615632923, 0.0, 4.6670547031690335, 0.8123221608547724,
                    -1.5509031539436366, 1.159623860392167, -2.15087002374623, 2.575144183646486, 1.9098310575266777, 1.9519680635884125, -0.836086754399737 },
            { -4.5743379690867085, -3.3794224706993727, -8.542430035477471, -8.19402211902889, -2.173207866882841, 0.4898449135890238, -2.606251254220393, -4.810226361475347, 0.9978128923388084,
                    -5.326149753076169, -0.3827647891106965, -9.420262581909716, -2.7357792050949716, -10.169838967831584, -4.102960697633316, -4.6670547031690335, 0.0, -2.996700838407445,
                    -9.55090215503318, -2.8156128752736835, -10.478319433443039, -2.1068264158795857, -2.257069004881763, -3.175150122410766, -8.325516256680547 },
            { -0.10957762135937045, 0.6787096862631289, -1.8313789714383482, -1.4217726514539801, 0.7631401337621757, 3.247115399239452, 0.5740313617855674, -0.23504679006508147, 3.532980936679062,
                    -1.4755914361405555, 2.8004976434756124, -2.0753761040104095, 0.32610864626717706, -2.2019905957559596, -0.20203188900357125, -0.8123221608547724, 2.996700838407445, 0.0,
                    -2.2929065485653415, 0.2832956071983129, -2.808625534566329, 1.380705232899937, 0.9046368513074614, 0.8073743432893147, -1.6755348819646767 },
            { 3.1119293708906817, 4.385723715300988, 0.7515728624646947, 1.5496079870977542, 3.455841810463986, 9.978581200433213, 3.3681040856609683, 2.9405299076363103, 10.934510502665026,
                    0.5389819211010917, 9.20602851959541, 0.4157923363366279, 2.8527689580452367, 0.26980781330087367, 2.5832085015300676, 1.5509031539436366, 9.55090215503318, 2.2929065485653415,
                    0.0, 2.814340722462289, -0.8797478014492714, 5.295282520926716, 3.9356582507969944, 4.58953972997576, 1.0290765115747231 },
            { -0.4623669163101819, 0.36745013438992363, -2.318695735343612, -1.8931384500093866, 0.49883317159491847, 3.0829526710150965, 0.2933369390415972, -0.5959818276679922, 3.3896161478842153,
                    -1.8372899934277052, 2.6061156471943416, -2.5897315730457655, 0.04570019208790191, -2.7368037599210866, -0.5358471467684961, -1.159623860392167, 2.8156128752736835,
                    -0.2832956071983129, -2.814340722462289, 0.0, -3.3627877895413008, 1.1127329146966327, 0.6332853153330308, 0.503223966962562, -2.1547094221068708 },
            { 3.847488901952086, 5.13258862065952, 1.6139167572556208, 2.4516855232020305, 4.005435344920185, 10.903028436118749, 3.949683988499305, 3.681169355993277, 11.904139685937364,
                    1.104698294233646, 10.134755741037285, 1.3199878692084621, 3.397428300056941, 1.2202750266555644, 3.228090980969453, 2.15087002374623, 10.478319433443039, 2.808625534566329,
                    0.8797478014492714, 3.3627877895413008, 0.0, 6.012769261799621, 4.538734204044188, 5.33707923102086, 1.8975135866290356 },
            { -1.9872843449972717, -0.9641392777825224, -4.60724240376844, -4.134083585631304, -0.5343777346816817, 2.4653239066815056, -0.8233148711884307, -2.162983287393847, 2.888563374401368,
                    -3.2918918698692883, 1.825633167975113, -5.057908133986295, -1.0531519593120247, -5.358481736640865, -1.9190991827753285, -2.575144183646486, 2.1068264158795857,
                    -1.380705232899937, -5.295282520926716, -1.1127329146966327, -6.012769261799621, 0.0, -0.4518647754278179, -0.7943841200139904, -4.406957238806471 },
            { -1.2649831272686793, -0.37105179122236903, -3.3782029780946603, -2.9366829511333234, -0.10585396353509212, 2.5535588194554126, -0.3473968242549808, -1.413234439651805,
                    2.8897991459908474, -2.5969634816944667, 2.024811804662633, -3.7060167356937135, -0.5818322689025421, -3.8998605735408263, -1.280357304295228, -1.9098310575266777,
                    2.257069004881763, -0.9046368513074614, -3.9356582507969944, -0.6332853153330308, -4.538734204044188, 0.4518647754278179, 0.0, -0.22392215847821853, -3.2023535093816977 },
            { -1.241905254598443, -0.17602352459404313, -3.8807398930698636, -3.368465276041657, 0.08787455481633125, 3.547935462509953, -0.17640739805382244, -1.4195990034270722, 4.034567893201614,
                    -2.712064269703533, 2.881757080971124, -4.331784194926644, -0.44605218656181583, -4.62775317926946, -1.2429556207920929, -1.9519680635884125, 3.175150122410766,
                    -0.8073743432893147, -4.58953972997576, -0.503223966962562, -5.33707923102086, 0.7943841200139904, 0.22392215847821853, 0.0, -3.6692725364865564 },
            { 2.2205956182513735, 3.4682700266542907, -0.26686415827163223, 0.47381376142504056, 2.7915065706044238, 8.750950351098394, 2.664834746042749, 2.0445281077922433, 9.624260654931957,
                    -0.12938356796602282, 7.984058639017171, -0.6469836071705186, 2.1975637845585387, -0.8442841381757844, 1.8073723757781983, 0.836086754399737, 8.325516256680547, 1.6755348819646767,
                    -1.0290765115747231, 2.1547094221068708, -1.8975135866290356, 4.406957238806471, 3.2023535093816977, 3.6692725364865564, 0.0 },
    };
    double[][] pvalTable = {
            { 1.0, 0.2871466720343605, 0.015718099381728523, 0.06113087297703279, 0.2947011110109039, 1.6778525742111583e-06, 0.403842589149187, 0.8662390191597573, 1.4256287239611254e-07,
                    0.09026777952628029, 2.8200990389803948e-05, 0.005167467192306763, 0.6083201806337459, 0.0024982708497784945, 0.8988639769831892, 0.37138883614876494, 8.414158198633004e-06,
                    0.9128553367958441, 0.0021335019339503436, 0.6443259005749744, 0.00016090191189466196, 0.04826936192406017, 0.20736414310740714, 0.21574056209118986, 0.027512080784199977 },
            { 0.2871466720343605, 1.0, 0.00029993390435434364, 0.0018138421341491462, 0.823265158725544, 0.0002309304810679258, 0.9732084771281775, 0.21501784174627203, 3.36668480651614e-05,
                    0.010857865832990088, 0.0023151419626836756, 5.477883984772447e-05, 0.7560281235243345, 1.6815893463251186e-05, 0.2786411720003672, 0.07268817077750378, 0.000874804335955881,
                    0.498114343928149, 1.876419933255491e-05, 0.7136757365000084, 6.801079066587334e-07, 0.3361521538090364, 0.7109956591278599, 0.860455359505405, 0.0006425929757265525 },
            { 0.015718099381728523, 0.00029993390435434364, 1.0, 0.45585291621981705, 0.0035167203375388034, 2.220446049250313e-16, 0.005033886311318847, 0.02474423412354443, 0.0, 0.9630883556233276,
                    2.90878432451791e-14, 0.7157627689777786, 0.01922976208886973, 0.5855925950916516, 0.04688187135152799, 0.3094044390453097, 3.552713678800501e-15, 0.06854670075541414,
                    0.4532003763388206, 0.02143217336202774, 0.10813801824129099, 7.2970293003571385e-06, 0.0008784788425570955, 0.00014176902571128025, 0.7898514863190971 },
            { 0.06113087297703279, 0.0018138421341491462, 0.45585291621981705, 1.0, 0.011884435452515607, 1.7763568394002505e-15, 0.017424643055497624, 0.0906450494376132, 0.0, 0.6643254754710419,
                    2.7755575615628914e-13, 0.2440543989450732, 0.054014344441254636, 0.16162547277376715, 0.13575118536812036, 0.5974281528313417, 3.086420008457935e-14, 0.15666550320939443,
                    0.12283251689947461, 0.05979800460727058, 0.015085669860296136, 5.260447462585027e-05, 0.0037104279017825537, 0.0009083413431145715, 0.6361547542313641 },
            { 0.2947011110109039, 0.823265158725544, 0.0035167203375388034, 0.011884435452515607, 1.0, 0.015488320674504008, 0.8234647102282251, 0.23686039120680702, 0.006740818465288401,
                    0.019845232916282818, 0.051056668908659564, 0.0014127959269463197, 0.6525540029458028, 0.0008224533945448975, 0.2790212813366655, 0.09297087274542304, 0.030951727865833556,
                    0.4462881127402396, 0.0006711761536843941, 0.618450650260904, 8.754340507421965e-05, 0.5936797284449291, 0.915805384818495, 0.9300651912071818, 0.00576010207415778 },
            { 1.6778525742111583e-06, 0.0002309304810679258, 2.220446049250313e-16, 1.7763568394002505e-15, 0.015488320674504008, 1.0, 0.004268992947684458, 5.557875797368439e-07, 0.634731907854341,
                    7.121285938715971e-08, 0.38429376106252455, 0.0, 0.003034547661584952, 0.0, 1.6346763008323606e-05, 1.5237001735890487e-06, 0.6247859404499154, 0.0013692098237374495, 0.0,
                    0.002341877191370134, 0.0, 0.014540182902510468, 0.01141553889749014, 0.00048479010798008204, 8.881784197001252e-16 },
            { 0.403842589149187, 0.9732084771281775, 0.005033886311318847, 0.017424643055497624, 0.8234647102282251, 0.004268992947684458, 1.0, 0.32897863797411375, 0.0015064659291532667,
                    0.02850257603902051, 0.018113455927128763, 0.001959433260175558, 0.807009100308395, 0.0011100438870954576, 0.3772511919703043, 0.13058108629632548, 0.009849942090619956,
                    0.5665980938774062, 0.000909467025424604, 0.7695718424282729, 0.00010875399829579635, 0.4113194879928441, 0.7286622086504158, 0.8601541952387919, 0.008337911654616281 },
            { 0.8662390191597573, 0.21501784174627203, 0.02474423412354443, 0.0906450494376132, 0.23686039120680702, 5.557875797368439e-07, 0.32897863797411375, 1.0, 4.078575899235659e-08,
                    0.11742401761430665, 1.0560546098492551e-05, 0.008663567278827555, 0.5188602807699843, 0.004379924470195196, 0.9810408916987221, 0.4501498762213487, 2.9813718351867635e-06,
                    0.8144153236957845, 0.0036665924441832143, 0.5518680514542944, 0.0002993353151485856, 0.03174085377113545, 0.15915693492736138, 0.15729692377242777, 0.0422248681648516 },
            { 1.4256287239611254e-07, 3.36668480651614e-05, 0.0, 0.0, 0.006740818465288401, 0.634731907854341, 0.0015064659291532667, 4.078575899235659e-08, 1.0, 1.1087010420851584e-08,
                    0.16177103822539163, 0.0, 0.0011320201462983182, 0.0, 2.699201128386619e-06, 2.4989657698704093e-07, 0.3195879573106324, 0.0005113151690325779, 0.0, 0.0008446461634001867, 0.0,
                    0.004300801276611255, 0.004284623361268336, 7.808955319377198e-05, 0.0 },
            { 0.09026777952628029, 0.010857865832990088, 0.9630883556233276, 0.6643254754710419, 0.019845232916282818, 7.121285938715971e-08, 0.02850257603902051, 0.11742401761430665,
                    1.1087010420851584e-08, 1.0, 7.525082401649286e-07, 0.7779599210424029, 0.062180446736953776, 0.6966510587273933, 0.14053485344441596, 0.44870710302820305, 2.711530253662886e-07,
                    0.1416420561555476, 0.5905048269806548, 0.06766589101132836, 0.27063095810327553, 0.0011783967730545353, 0.01011106459969957, 0.007274902568656039, 0.8971854870523459 },
            { 2.8200990389803948e-05, 0.0023151419626836756, 2.90878432451791e-14, 2.7755575615628914e-13, 0.051056668908659564, 0.38429376106252455, 0.018113455927128763, 1.0560546098492551e-05,
                    0.16177103822539163, 7.525082401649286e-07, 1.0, 0.0, 0.012259754444186699, 0.0, 0.00015667011977615886, 1.5088193166867825e-05, 0.7023047530606426, 0.005608088104749331, 0.0,
                    0.009853710668938476, 0.0, 0.06941197103759311, 0.044229573135349476, 0.004390909251123176, 1.1302070390684094e-13 },
            { 0.005167467192306763, 5.477883984772447e-05, 0.7157627689777786, 0.2440543989450732, 0.0014127959269463197, 0.0, 0.001959433260175558, 0.008663567278827555, 0.0, 0.7779599210424029, 0.0,
                    1.0, 0.009211074441921152, 0.862923783202203, 0.021314021973458663, 0.19800011270837214, 0.0, 0.03924387870785795, 0.6780122519144749, 0.010318669887999565, 0.18836308423586168,
                    9.635875533042793e-07, 0.00027318535576537073, 2.3493472470326182e-05, 0.5183918860527874 },
            { 0.6083201806337459, 0.7560281235243345, 0.01922976208886973, 0.054014344441254636, 0.6525540029458028, 0.003034547661584952, 0.807009100308395, 0.5188602807699843, 0.0011320201462983182,
                    0.062180446736953776, 0.012259754444186699, 0.009211074441921152, 1.0, 0.006025202125593099, 0.5603847911586044, 0.23070005357150802, 0.006788760342852251, 0.7446865656533612,
                    0.004794310652375344, 0.9635952691337171, 0.0008221944241708634, 0.29355485837660256, 0.5613415185367734, 0.6560469395135131, 0.02913999571445358 },
            { 0.0024982708497784945, 1.6815893463251186e-05, 0.5855925950916516, 0.16162547277376715, 0.0008224533945448975, 0.0, 0.0011100438870954576, 0.004379924470195196, 0.0, 0.6966510587273933,
                    0.0, 0.862923783202203, 0.006025202125593099, 1.0, 0.013252516249647739, 0.15441841517845378, 0.0, 0.0288207714318085, 0.7875890995355441, 0.006768436339636086,
                    0.22381198228808596, 2.3201192633770518e-07, 0.00013176608043852234, 6.6745135760548635e-06, 0.39952957926571564 },
            { 0.8988639769831892, 0.2786411720003672, 0.04688187135152799, 0.13575118536812036, 0.2790212813366655, 1.6346763008323606e-05, 0.3772511919703043, 0.9810408916987221,
                    2.699201128386619e-06, 0.14053485344441596, 0.00015667011977615886, 0.021314021973458663, 0.5603847911586044, 0.013252516249647739, 1.0, 0.4736220215739593, 5.9568581225244444e-05,
                    0.8400992196691042, 0.010509196933885523, 0.5926656132168697, 0.0014586656940163145, 0.05640968517976419, 0.2019174007758664, 0.21535406142524272, 0.0722220856911091 },
            { 0.37138883614876494, 0.07268817077750378, 0.3094044390453097, 0.5974281528313417, 0.09297087274542304, 1.5237001735890487e-06, 0.13058108629632548, 0.4501498762213487,
                    2.4989657698704093e-07, 0.44870710302820305, 1.5088193166867825e-05, 0.19800011270837214, 0.23070005357150802, 0.15441841517845378, 0.4736220215739593, 1.0, 5.621661298471636e-06,
                    0.4175823709772777, 0.12252179552985676, 0.24759845267889768, 0.032698188561780306, 0.010749096237534062, 0.057600374448060876, 0.05235214588576542, 0.40411394948128887 },
            { 8.414158198633004e-06, 0.000874804335955881, 3.552713678800501e-15, 3.086420008457935e-14, 0.030951727865833556, 0.6247859404499154, 0.009849942090619956, 2.9813718351867635e-06,
                    0.3195879573106324, 2.711530253662886e-07, 0.7023047530606426, 0.0, 0.006788760342852251, 0.0, 5.9568581225244444e-05, 5.621661298471636e-06, 1.0, 0.003078320501143761, 0.0,
                    0.005360730760296084, 0.0, 0.03639191270279407, 0.02509573640968621, 0.001736966111577587, 1.3766765505351941e-14 },
            { 0.9128553367958441, 0.498114343928149, 0.06854670075541414, 0.15666550320939443, 0.4462881127402396, 0.0013692098237374495, 0.5665980938774062, 0.8144153236957845, 0.0005113151690325779,
                    0.1416420561555476, 0.005608088104749331, 0.03924387870785795, 0.7446865656533612, 0.0288207714318085, 0.8400992196691042, 0.4175823709772777, 0.003078320501143761, 1.0,
                    0.022903954451297892, 0.7772462234060167, 0.005473816373038343, 0.16892616380333547, 0.3667572018404355, 0.42041967304830097, 0.09540778278756079 },
            { 0.0021335019339503436, 1.876419933255491e-05, 0.4532003763388206, 0.12283251689947461, 0.0006711761536843941, 0.0, 0.000909467025424604, 0.0036665924441832143, 0.0, 0.5905048269806548,
                    0.0, 0.6780122519144749, 0.004794310652375344, 0.7875890995355441, 0.010509196933885523, 0.12252179552985676, 0.0, 0.022903954451297892, 1.0, 0.005381160118725026,
                    0.38006243142058294, 3.14476073182135e-07, 0.00011481330253926281, 7.878973532049471e-06, 0.30469917638085375 },
            { 0.6443259005749744, 0.7136757365000084, 0.02143217336202774, 0.05979800460727058, 0.618450650260904, 0.002341877191370134, 0.7695718424282729, 0.5518680514542944, 0.0008446461634001867,
                    0.06766589101132836, 0.009853710668938476, 0.010318669887999565, 0.9635952691337171, 0.006768436339636086, 0.5926656132168697, 0.24759845267889768, 0.005360730760296084,
                    0.7772462234060167, 0.005381160118725026, 1.0, 0.0009261871498762453, 0.26717227899127294, 0.5272781306313865, 0.6153661582297021, 0.032392091417803304 },
            { 0.00016090191189466196, 6.801079066587334e-07, 0.10813801824129099, 0.015085669860296136, 8.754340507421965e-05, 0.0, 0.00010875399829579635, 0.0002993353151485856, 0.0,
                    0.27063095810327553, 0.0, 0.18836308423586168, 0.0008221944241708634, 0.22381198228808596, 0.0014586656940163145, 0.032698188561780306, 0.0, 0.005473816373038343,
                    0.38006243142058294, 0.0009261871498762453, 1.0, 8.646999338779437e-09, 9.808099303176832e-06, 2.572523558619366e-07, 0.059215335418212556 },
            { 0.04826936192406017, 0.3361521538090364, 7.2970293003571385e-06, 5.260447462585027e-05, 0.5936797284449291, 0.014540182902510468, 0.4113194879928441, 0.03174085377113545,
                    0.004300801276611255, 0.0011783967730545353, 0.06941197103759311, 9.635875533042793e-07, 0.29355485837660256, 2.3201192633770518e-07, 0.05640968517976419, 0.010749096237534062,
                    0.03639191270279407, 0.16892616380333547, 3.14476073182135e-07, 0.26717227899127294, 8.646999338779437e-09, 1.0, 0.6518609981112706, 0.4279229363509982, 1.7165548422015675e-05 },
            { 0.20736414310740714, 0.7109956591278599, 0.0008784788425570955, 0.0037104279017825537, 0.915805384818495, 0.01141553889749014, 0.7286622086504158, 0.15915693492736138,
                    0.004284623361268336, 0.01011106459969957, 0.044229573135349476, 0.00027318535576537073, 0.5613415185367734, 0.00013176608043852234, 0.2019174007758664, 0.057600374448060876,
                    0.02509573640968621, 0.3667572018404355, 0.00011481330253926281, 0.5272781306313865, 9.808099303176832e-06, 0.6518609981112706, 1.0, 0.8230487530584529, 0.001588339924907256 },
            { 0.21574056209118986, 0.860455359505405, 0.00014176902571128025, 0.0009083413431145715, 0.9300651912071818, 0.00048479010798008204, 0.8601541952387919, 0.15729692377242777,
                    7.808955319377198e-05, 0.007274902568656039, 0.004390909251123176, 2.3493472470326182e-05, 0.6560469395135131, 6.6745135760548635e-06, 0.21535406142524272, 0.05235214588576542,
                    0.001736966111577587, 0.42041967304830097, 7.878973532049471e-06, 0.6153661582297021, 2.572523558619366e-07, 0.4279229363509982, 0.8230487530584529, 1.0, 0.000312675888899383 },
            { 0.027512080784199977, 0.0006425929757265525, 0.7898514863190971, 0.6361547542313641, 0.00576010207415778, 8.881784197001252e-16, 0.008337911654616281, 0.0422248681648516, 0.0,
                    0.8971854870523459, 1.1302070390684094e-13, 0.5183918860527874, 0.02913999571445358, 0.39952957926571564, 0.0722220856911091, 0.40411394948128887, 1.3766765505351941e-14,
                    0.09540778278756079, 0.30469917638085375, 0.032392091417803304, 0.059215335418212556, 1.7165548422015675e-05, 0.001588339924907256, 0.000312675888899383, 1.0 },
    };

    // test constants
    double EQUALITY_DELTA = 1e-6;
    double ALPHA = .05;

    public Dataframe generate(int col) {
        List<PredictionInput> ps = new ArrayList<>();
        for (int i = 0; i < cols[0].length; i++) {
            ps.add(new PredictionInput(List.of(FeatureFactory.newNumericalFeature(String.valueOf(i), cols[col][i]))));
        }
        return Dataframe.createFromInputs(ps);
    }

    public Dataframe generate(Integer[] colIdxs) {
        return generate(colIdxs, false, "");
    }

    public Dataframe generate(Integer[] colIdxs, boolean addString) {
        return generate(colIdxs, addString, "");
    }

    public Dataframe generate(Integer[] colIdxs, boolean addString, String colPrefix) {
        List<PredictionInput> ps = new ArrayList<>();
        for (int i = 0; i < cols[0].length; i++) {
            List<Feature> fs = new ArrayList<>();
            AtomicInteger colName = new AtomicInteger(0);
            for (int colIdx : colIdxs) {
                fs.add(FeatureFactory.newNumericalFeature(colPrefix + colName.getAndIncrement(), cols[colIdx][i]));
            }
            if (addString) {
                fs.add(FeatureFactory.newTextFeature(colPrefix + "text", "text"));
            }
            ps.add(new PredictionInput(fs));
        }
        return Dataframe.createFromInputs(ps);
    }

    // check meanshift scores for all column pairings
    @Test
    void testTTestOneColumn() {
        for (int i = 0; i < nReferenceCols; i++) {
            for (int j = 0; j < nReferenceCols; j++) {
                Dataframe df1 = generate(i);
                Dataframe df2 = generate(j);
                Meanshift ms = new Meanshift(df1);
                Map<String, MeanshiftResult> msResults = ms.calculate(df2, ALPHA);

                assertEquals(pvalTable[i][j], msResults.get("0").getpValue(), EQUALITY_DELTA);
                assertEquals(tstatTable[i][j], msResults.get("0").gettStat(), EQUALITY_DELTA);
                assertEquals(pvalTable[i][j] <= ALPHA, msResults.get("0").isReject());
            }
        }
    }

    // check that meanshift scores are correct in multi-column cases
    void nColumnCase(boolean withText, boolean precompute) {
        Random rn = new Random(0);
        int ncols = 100;
        Integer[] idx1 = new Integer[ncols];
        Integer[] idx2 = new Integer[ncols];

        // generate two dataframes, consisting of a random ordering of columns drawn from cols
        for (int i = 0; i < ncols; i++) {
            idx1[i] = rn.nextInt(nReferenceCols);
            idx2[i] = rn.nextInt(nReferenceCols);
        }

        Dataframe df1 = generate(idx1, withText);
        Dataframe df2 = generate(idx2, withText);
        List<String> df1Names = df1.getColumnNames();
        List<String> df2Names = df2.getColumnNames();

        Meanshift ms;
        if (precompute) {
            MeanshiftFitting msf = Meanshift.precompute(df1);
            ms = new Meanshift(msf);
        } else {
            ms = new Meanshift(df1);
        }

        Map<String, MeanshiftResult> msResults = ms.calculate(df2, ALPHA);
        for (Map.Entry<String, MeanshiftResult> entry : msResults.entrySet()) {
            int i = df1Names.indexOf(entry.getKey());
            int refRow = idx1[i];
            int refCol = idx2[i];

            assertEquals(tstatTable[refRow][refCol], msResults.get(entry.getKey()).gettStat(), EQUALITY_DELTA);
            assertEquals(pvalTable[refRow][refCol], msResults.get(entry.getKey()).getpValue(), EQUALITY_DELTA);
            assertEquals(pvalTable[refRow][refCol] <= ALPHA, msResults.get(entry.getKey()).isReject());
        }
    }

    @Test
    void testTTestNColumn() {
        nColumnCase(false, false);
    }

    @Test
    void testTTestNColumnPrecomputed() {
        nColumnCase(false, true);
    }

    @Test
    void testNonNumericColumn() {
        nColumnCase(true, false);
    }

    @Test
    void testMismatchingColumns() {
        Random rn = new Random(0);
        int ncols = 100;
        Integer[] idx1 = new Integer[ncols];
        Integer[] idx2 = new Integer[ncols];

        // generate two dataframes, consisting of a random ordering of columns drawn from cols
        for (int i = 0; i < ncols; i++) {
            idx1[i] = rn.nextInt(nReferenceCols);
            idx2[i] = rn.nextInt(nReferenceCols);
        }

        Dataframe df1 = generate(idx1, false);
        Dataframe df2 = generate(idx2, false, "mismatch");

        Meanshift ms = new Meanshift(df1);
        assertThrows(IllegalArgumentException.class, () -> ms.calculate(df2, ALPHA));
    }

}
